# EquiMind v2.0

EquiMind æ˜¯ä¸€ä¸ªåŸºäº **LangChain + LangGraph** çš„æ™ºèƒ½æŠ•èµ„å†³ç­–å¹³å°ã€‚å®ƒæ”¯æŒå¤šå·¥å…·é›†æˆã€ä¸Šä¸‹æ–‡é©±åŠ¨çš„æ™ºèƒ½å†³ç­–ï¼Œå¹¶å¯é€šè¿‡ API å®ç°è‡ªåŠ¨åŒ–é€‰è‚¡ã€æ¶ˆæ¯æ¨é€å’Œäº¤æ˜“ã€‚

## ğŸš€ æ–°ç‰ˆæœ¬ç‰¹æ€§

### LangChain é›†æˆ
- **æ™ºèƒ½ Agent**ï¼šåŸºäº LangChain çš„å¯¹è¯å¼æŠ•èµ„åŠ©æ‰‹
- **è‡ªåŠ¨å·¥å…·é€‰æ‹©**ï¼šæ ¹æ®ç”¨æˆ·æ„å›¾æ™ºèƒ½é€‰æ‹©åˆé€‚çš„å·¥å…·
- **ä¸Šä¸‹æ–‡è®°å¿†**ï¼šå®Œæ•´çš„å¯¹è¯å†å²å’ŒçŠ¶æ€ç®¡ç†
- **ç»“æ„åŒ–è¾“å‡º**ï¼šæ ‡å‡†åŒ–çš„å·¥å…·è¾“å…¥è¾“å‡ºæ ¼å¼

### LangGraph å·¥ä½œæµ
- **å¤šæ­¥éª¤æŠ•èµ„å†³ç­–**ï¼šå¸‚åœºåˆ†æ â†’ è‚¡ç¥¨ç­›é€‰ â†’ é£é™©è¯„ä¼° â†’ æ¨è
- **æ¡ä»¶åˆ†æ”¯**ï¼šæ ¹æ®å¸‚åœºæƒ…å†µé€‰æ‹©ä¸åŒç­–ç•¥
- **çŠ¶æ€ç®¡ç†**ï¼šè·Ÿè¸ªæŠ•èµ„ç»„åˆå’Œå†³ç­–å†å²
- **å¯æ‰©å±•å·¥ä½œæµ**ï¼šæ”¯æŒè‡ªå®šä¹‰æŠ•èµ„ç­–ç•¥

## é¡¹ç›®å®šä½
- æ™ºèƒ½é‡åŒ–æŠ•èµ„ Agent
- æ”¯æŒå¤šå·¥å…·æ’ä»¶ï¼ˆè¡Œæƒ…ã€ç­–ç•¥ã€æ¨é€ã€äº¤æ˜“ç­‰ï¼‰
- åŸºäº LangChain + LangGraph çš„ç°ä»£åŒ–æ¶æ„
- å¯æ‰©å±•ã€å¯é›†æˆã€è‡ªåŠ¨åŒ–

## ä¸»è¦åŠŸèƒ½
- å®æ—¶è·å–è‚¡ç¥¨è¡Œæƒ…æ•°æ®
- æ™ºèƒ½è‚¡ç¥¨ç­›é€‰ï¼ˆå¤šå› å­åˆ†æï¼‰
- æŠ•èµ„å†³ç­–å·¥ä½œæµ
- é£é™©è¯„ä¼°å’Œæ¨è
- æä¾›æ ‡å‡†åŒ– API æœåŠ¡

## æ¶æ„è¯´æ˜
```
EquiMind/
  â”œâ”€â”€ mcp_server/                # LangChain Agent Server
  â”‚     â”œâ”€â”€ server.py            # FastAPI ä¸»æœåŠ¡ï¼Œæ”¯æŒå¤šç§æ¨¡å¼
  â”‚     â”œâ”€â”€ langchain_agent.py   # LangChain Agent å®ç°
  â”‚     â”œâ”€â”€ investment_workflow.py # LangGraph æŠ•èµ„å·¥ä½œæµ
  â”‚     â”œâ”€â”€ tools/
  â”‚           â”œâ”€â”€ langchain_tools.py # LangChain å·¥å…·å®ç°
  â”‚           â””â”€â”€ smart_stock_screening.py # åŸæœ‰å·¥å…·ï¼ˆå…¼å®¹ï¼‰
  â”œâ”€â”€ frontend_streamlit/        # Streamlit å‰ç«¯
  â”‚     â””â”€â”€ app.py               # ç°ä»£åŒ–å‰ç«¯ç•Œé¢
  â”œâ”€â”€ requirements.txt           # ä¾èµ–åŒ…
  â”œâ”€â”€ config.py                  # é…ç½®æ–‡ä»¶
  â””â”€â”€ env_example.txt           # ç¯å¢ƒå˜é‡ç¤ºä¾‹
```

## å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–
```bash
pip install -r requirements.txt
```

### 2. é…ç½®ç¯å¢ƒå˜é‡
```bash
# å¤åˆ¶ç¯å¢ƒå˜é‡ç¤ºä¾‹æ–‡ä»¶
cp env_example.txt .env

# ç¼–è¾‘ .env æ–‡ä»¶ï¼Œå¡«å…¥ä½ çš„ API Keys
# æ”¯æŒ OpenAI æˆ– OpenRouter API Key
OPENAI_API_KEY=your_openai_or_openrouter_api_key_here
ALPHAVANTAGE_API_KEY=your_alphavantage_api_key_here

# å¦‚æœä½¿ç”¨ OpenRouterï¼Œå¯ä»¥è®¾ç½®åŸºç¡€ URLï¼ˆå¯é€‰ï¼‰
OPENROUTER_BASE_URL=https://openrouter.ai/api/v1
```

### 3. å¯åŠ¨ LangChain Server
```bash
uvicorn mcp_server.server:app --host 0.0.0.0 --port 8000
```

### 4. è¿è¡Œå‰ç«¯é¡µé¢
```bash
streamlit run frontend_streamlit/app.py
```

### 5. åœ¨æµè§ˆå™¨è®¿é—®å‰ç«¯é¡µé¢
- é€‰æ‹©å¤„ç†æ¨¡å¼ï¼ˆæ™ºèƒ½ Agent / æŠ•èµ„å·¥ä½œæµ / ç›´æ¥å·¥å…·è°ƒç”¨ï¼‰
- è¾“å…¥ä½ çš„æŠ•èµ„éœ€æ±‚
- æŸ¥çœ‹æ™ºèƒ½åˆ†æç»“æœ

## API æ¥å£

### 1. æ™ºèƒ½ Agent æŸ¥è¯¢
```bash
POST /agent/query
{
  "user_query": "å¸®æˆ‘æ¨è5ä¸ªç°åœ¨é€‚åˆæŠ•èµ„çš„ç¾è‚¡",
  "context": {"user_id": "leo", "risk_preference": "moderate"}
}
```

### 2. æŠ•èµ„å·¥ä½œæµ
```bash
POST /workflow/investment
{
  "user_query": "å¸®æˆ‘åˆ†æå½“å‰ç§‘æŠ€è‚¡æŠ•èµ„æœºä¼š",
  "context": {"user_id": "leo"}
}
```

### 3. å…¼å®¹åŸæœ‰ MCP æ¥å£
```bash
POST /mcp/call
{
  "tool_name": "smart_stock_screening",
  "inputs": {"top_n": 5}
}
```

## æ¨¡å¼è¯´æ˜

### 1. æ™ºèƒ½ä½“ï¼ˆAgentï¼‰æ¨¡å¼
- åŸºäº LangChain çš„å¯¹è¯å¼æ™ºèƒ½åŠ©æ‰‹ï¼Œç”¨æˆ·ç”¨è‡ªç„¶è¯­è¨€æé—®ï¼ŒAgent è‡ªåŠ¨ç†è§£æ„å›¾ã€é€‰æ‹©åˆé€‚å·¥å…·ï¼ˆå¦‚é€‰è‚¡ã€æŸ¥è¡Œæƒ…ã€åˆ†æè´¢æŠ¥ç­‰ï¼‰ï¼Œå¹¶ç»™å‡ºç»“æ„åŒ–æˆ–è‡ªç„¶è¯­è¨€ç­”æ¡ˆã€‚
- æ”¯æŒå¤šè½®å¯¹è¯å’Œä¸Šä¸‹æ–‡è®°å¿†ï¼Œèƒ½ç†è§£è¿½é—®ã€æŒ‡ä»£ã€è¡¥å……ç­‰å¤æ‚è¯­å¢ƒã€‚
- é€‚åˆâ€œåƒå’ŒæŠ•é¡¾èŠå¤©ä¸€æ ·â€çš„æ™ºèƒ½æŠ•ç ”ä½“éªŒã€‚
- åº•å±‚å®ç°ï¼šLangChain Agent + ConversationBufferMemory è®°å¿†æ¨¡å— + å¤šå·¥å…·è‡ªåŠ¨è°ƒåº¦ã€‚

### 2. å·¥ä½œæµï¼ˆWorkflowï¼‰æ¨¡å¼
- åŸºäº LangGraph çš„å¤šæ­¥éª¤å†³ç­–æµç¨‹ï¼Œå°†æŠ•èµ„å†³ç­–æ‹†åˆ†ä¸ºå¸‚åœºåˆ†æâ†’è‚¡ç¥¨ç­›é€‰â†’é£é™©è¯„ä¼°â†’æ¨èç­‰ç¯èŠ‚ï¼Œæ¯æ­¥å¯ç‹¬ç«‹æ‰©å±•å’Œè°ƒè¯•ã€‚
- é€‚åˆæ ‡å‡†åŒ–ã€ç»“æ„åŒ–çš„æŠ•ç ”æµç¨‹ï¼Œå¦‚è‡ªåŠ¨åŒ–æŠ•ç ”æŠ¥å‘Šã€æŠ•èµ„å†³ç­–æµæ°´çº¿ã€‚
- åº•å±‚å®ç°ï¼šLangGraph çŠ¶æ€æœº + å¤šå·¥å…·ç»„åˆ + æ¯æ­¥çŠ¶æ€å¯è¿½è¸ªã€‚

### 3. ç›´æ¥å·¥å…·è°ƒç”¨
- ç›´æ¥è°ƒç”¨åº•å±‚æŸä¸ªå·¥å…·ï¼ˆå¦‚é€‰è‚¡ã€æŸ¥è¡Œæƒ…ï¼‰ï¼Œæ— éœ€æ™ºèƒ½æ¨ç†å’Œä¸Šä¸‹æ–‡ã€‚
- é€‚åˆå‰ç«¯å¼€å‘ã€APIå¯¹æ¥ã€è‡ªåŠ¨åŒ–è„šæœ¬ã€å•å·¥å…·è°ƒè¯•ã€‚
- å…¼å®¹ MCP åè®®ï¼Œä¾¿äºè€ç³»ç»Ÿè¿ç§»ã€‚

## è®°å¿†æ¨¡å—è¯´æ˜
- æ™ºèƒ½ä½“æ¨¡å¼ä¸‹ï¼Œç³»ç»Ÿè‡ªåŠ¨è®°å½•å®Œæ•´çš„å†å²å¯¹è¯ï¼ˆç”¨æˆ·è¾“å…¥+AIå›å¤ï¼‰ï¼Œæ”¯æŒå¤šè½®è¿½é—®ã€ä¸Šä¸‹æ–‡ç†è§£ã€‚
- é»˜è®¤ä¿å­˜å…¨éƒ¨åŸæ–‡ï¼ˆä¸åšæ‘˜è¦ï¼‰ï¼Œå¯é…ç½®åªä¿ç•™æœ€è¿‘Nè½®æˆ–ç”¨æ‘˜è¦æœºåˆ¶å‹ç¼©å†å²ã€‚
- è®°å¿†æ¨¡å—è®©Agentèƒ½åƒçœŸäººä¸€æ ·ç†è§£â€œå®ƒâ€ã€â€œå†æ¥ä¸€ä¸ªâ€ã€â€œä¸Šæ¬¡é‚£ä¸ªâ€ç­‰æŒ‡ä»£ã€‚
- å·¥ä½œæµå’Œå·¥å…·è°ƒç”¨æ¨¡å¼ä¸€èˆ¬æ— é•¿æœŸè®°å¿†ï¼Œä»…åœ¨æœ¬æµç¨‹å†…çŸ­æš‚ä¿å­˜çŠ¶æ€ã€‚

## æ™ºèƒ½ä½“ï¼ˆAgentï¼‰å®Œæ•´æµç¨‹
1. ç”¨æˆ·è¾“å…¥è‡ªç„¶è¯­è¨€é—®é¢˜ï¼Œå‰ç«¯å‘é€åˆ° /agent/queryã€‚
2. åç«¯åˆå§‹åŒ– Agentï¼Œè½½å…¥å·¥å…·å’Œè®°å¿†æ¨¡å—ã€‚
3. Agent ç»„è£…å†å²å¯¹è¯å’Œæœ¬æ¬¡è¾“å…¥ï¼Œä½œä¸º LLM è¾“å…¥ã€‚
4. LLM æ¨ç†æ„å›¾ï¼Œè‡ªåŠ¨é€‰æ‹©åˆé€‚å·¥å…·å’Œå‚æ•°ã€‚
5. Agent è°ƒç”¨å·¥å…·ï¼ˆå¦‚é€‰è‚¡ã€æŸ¥è¡Œæƒ…ï¼‰ï¼Œè·å–ç»“æ„åŒ–ç»“æœã€‚
6. LLM æ ¹æ®å·¥å…·ç»“æœç”Ÿæˆè‡ªç„¶è¯­è¨€å›å¤ã€‚
7. Agent è¿”å›å›å¤å’Œç»“æ„åŒ–æ•°æ®ï¼Œå‰ç«¯å±•ç¤ºã€‚
8. ç”¨æˆ·å¯ç»§ç»­è¿½é—®ï¼ŒAgent è‡ªåŠ¨åˆ©ç”¨è®°å¿†ç†è§£ä¸Šä¸‹æ–‡ã€‚

## å…¸å‹ä½¿ç”¨åœºæ™¯
- æ™ºèƒ½æŠ•é¡¾å¯¹è¯ã€è‡ªåŠ¨åŒ–æŠ•ç ”æŠ¥å‘Šã€APIé›†æˆã€æ‰¹é‡æ•°æ®å¤„ç†ç­‰ã€‚

## å…¸å‹ä½¿ç”¨ä¾‹å­

### ä¾‹1ï¼šæ™ºèƒ½ Agent å¯¹è¯
- **è¾“å…¥**ï¼šå¸®æˆ‘æ¨è5ä¸ªç°åœ¨é€‚åˆæŠ•èµ„çš„ç¾è‚¡
- **Agent å›å¤**ï¼šåŸºäºå½“å‰å¸‚åœºåˆ†æï¼Œæˆ‘ä¸ºæ‚¨æ¨èä»¥ä¸‹5åªç§‘æŠ€è‚¡...
- **ç‰¹ç‚¹**ï¼šè‡ªåŠ¨å·¥å…·é€‰æ‹©ã€ä¸Šä¸‹æ–‡è®°å¿†ã€è‡ªç„¶å¯¹è¯

### ä¾‹2ï¼šæŠ•èµ„å·¥ä½œæµåˆ†æ
- **è¾“å…¥**ï¼šåˆ†æå½“å‰ç§‘æŠ€è‚¡æŠ•èµ„æœºä¼š
- **å·¥ä½œæµ**ï¼š
  1. å¸‚åœºåˆ†æï¼šå½“å‰ç§‘æŠ€è‚¡æ•´ä½“è¡¨ç°...
  2. è‚¡ç¥¨ç­›é€‰ï¼šç­›é€‰å‡º5åªä¼˜è´¨ç§‘æŠ€è‚¡
  3. é£é™©è¯„ä¼°ï¼šè¯„ä¼°æ¯åªè‚¡ç¥¨çš„é£é™©ç­‰çº§
  4. æœ€ç»ˆæ¨èï¼šç»¼åˆå»ºè®®å’ŒæŠ•èµ„ç­–ç•¥

### ä¾‹3ï¼šç›´æ¥å·¥å…·è°ƒç”¨
- **è¾“å…¥**ï¼šæŸ¥è¯¢è‹¹æœå…¬å¸å½“å‰è‚¡ä»·
- **è¿”å›**ï¼š{"symbol": "AAPL", "price": 190.5, "volume": 1234567}

## æ‰©å±•æ–¹å¼

### æ·»åŠ æ–°å·¥å…·
```python
from langchain.tools import BaseTool

class MyNewTool(BaseTool):
    name = "my_new_tool"
    description = "æˆ‘çš„æ–°å·¥å…·æè¿°"
    
    def _run(self, **kwargs):
        # å·¥å…·é€»è¾‘
        return result
```

### æ³¨å†Œåˆ° Agent
```python
# åœ¨ langchain_agent.py ä¸­æ·»åŠ 
self.tools.append(MyNewTool())
```

### æ‰©å±•å·¥ä½œæµ
```python
# åœ¨ investment_workflow.py ä¸­æ·»åŠ æ–°èŠ‚ç‚¹
def my_new_node(state: InvestmentState) -> InvestmentState:
    # æ–°èŠ‚ç‚¹é€»è¾‘
    return state

workflow.add_node("my_new_node", my_new_node)
```

## æŠ€æœ¯æ ˆ

- **åç«¯æ¡†æ¶**ï¼šFastAPI + LangChain + LangGraph
- **å‰ç«¯æ¡†æ¶**ï¼šStreamlit
- **LLM é›†æˆ**ï¼šOpenAI GPT / OpenRouter
- **æ•°æ®æº**ï¼šAlphaVantage API
- **çŠ¶æ€ç®¡ç†**ï¼šLangGraph State Management

## é€‚ç”¨åœºæ™¯
- ä¸ªäººæŠ•èµ„è€…æ™ºèƒ½é€‰è‚¡
- é‡åŒ–æŠ•èµ„ç­–ç•¥å¼€å‘
- æŠ•èµ„é¡¾é—®å·¥å…·
- é‡‘èæ•™è‚²å¹³å°
- è‡ªåŠ¨åŒ–äº¤æ˜“ç³»ç»Ÿ

## å¼€å‘è®¡åˆ’
- [ ] æ”¯æŒæ›´å¤šæ•°æ®æºï¼ˆYahoo Financeã€IEX Cloudï¼‰
- [ ] å¢åŠ æŠ€æœ¯æŒ‡æ ‡åˆ†æ
- [ ] å®ç°å›æµ‹åŠŸèƒ½
- [ ] æ·»åŠ é£é™©ç®¡ç†æ¨¡å—
- [ ] æ”¯æŒå¤šè¯­è¨€ç•Œé¢
- [ ] ç§»åŠ¨ç«¯é€‚é…

## è´¡çŒ®æŒ‡å—
æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

## è®¸å¯è¯
MIT License
